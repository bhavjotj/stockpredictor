# S&P 500 Stock Predictor

## Overview

This project aims to predict the direction of the S&P 500 index's closing price using historical data and machine learning. The model leverages the Random Forest Classifier to make predictions based on various features derived from the historical data. The project involves data preprocessing, feature engineering, model training, backtesting, and visualization.

## Table of Contents

1. [Project Description](#project-description)
2. [Dependencies](#dependencies)
3. [Data](#data)
4. [Model Training and Evaluation](#model-training-and-evaluation)
5. [Backtesting](#backtesting)
6. [Feature Engineering](#feature-engineering)
7. [Results and Visualization](#results-and-visualization)
8. [File Structure](#file-structure)
9. [Next Steps](#next-steps)

## Project Description

The goal of this project is to predict whether the S&P 500 index's closing price will go up or down the next day. The prediction is based on historical price data from January 2000 onward. The machine learning model used is a Random Forest Classifier, which is trained on features derived from the historical data.

## Dependencies

To run this project, you need the following Python packages:

- `yfinance`: For downloading historical stock data
- `pandas`: For data manipulation
- `scikit-learn`: For machine learning algorithms and evaluation metrics
- `matplotlib`: For data visualization

You can install the required packages using pip:

```bash
pip install yfinance pandas scikit-learn matplotlib
```

## Data

The data for this project is obtained from Yahoo Finance using the `yfinance` library. The dataset includes historical information for the S&P 500 index (symbol: ^GSPC) from January 2000 onwards. The following columns are used:

- `Open`
- `High`
- `Low`
- `Close`
- `Volume`

Additional columns are generated for modeling purposes:

- `Tomorrow`: The closing price for the next day.
- `Target`: Binary target variable indicating whether the price will go up (`1`) or down (`0`).

## Model Training and Evaluation

### Training

The Random Forest Classifier is trained with the following hyperparameters:

- `n_estimators=200`: Number of trees in the forest
- `min_samples_split=100`: Minimum number of samples required to split an internal node
- `min_samples_leaf=5`: Minimum number of samples required to be at a leaf node
- `random_state=1`: Seed used by the random number generator

The model is trained using features:

- `Open`
- `High`
- `Low`
- `Close`
- `Volume`

### Evaluation

The model is evaluated using precision score on the test set. Initial precision score is around 0.52.

## Backtesting

Backtesting is performed to evaluate the model's performance over time. The backtesting process involves:

- Training the model on historical data up to a certain point.
- Testing the model on a subsequent period.
- Repeating this process with a rolling window approach.

## Feature Engineering

Additional features are created to improve the model's performance:

- **Rolling Averages**: Average closing price over various horizons.
- **Ratios**: Ratios of the closing price to rolling averages.
- **Trends**: Trends based on historical target values.

## Results and Visualization

The final model, with improved hyperparameters:

- `n_estimators=500`
- `min_samples_split=10`

achieves a precision score of approximately 0.56. The results are visualized by plotting the actual closing prices alongside the model's predictions, with upward and downward movements highlighted.

### Visualization

A plot is generated showing:

- Actual closing prices of the S&P 500 index.
- Predicted upward movements (green markers).
- Predicted downward movements (red markers).

## File Structure

The project directory includes:

- `sp500_hist.csv`: Historical data of the S&P 500 index.
- `sp500_predicts.csv`: Predictions generated by the model.
- `StockPredictor.ipynb`: Jupyter Notebook containing the project code and analysis.

## Next Steps

To enhance the S&P 500 stock predictor:

1. **Feature Engineering**: Add more features like technical indicators (MACD, RSI) and use feature selection techniques to refine the model.
2. **Model Improvement**: Tune hyperparameters with Grid Search or Random Search and experiment with other algorithms (e.g., GBM, SVM) for better performance.
3. **Backtesting Enhancements**: Improve backtesting with cross-validation and evaluate additional metrics (e.g., recall, F1-score).
4. **Visualizing Predictions**: Create a plot to visualize predicted future trends alongside actual prices.
5. **Documentation and Reporting**: Update project documentation and create detailed reports on model performance and feature importance.
